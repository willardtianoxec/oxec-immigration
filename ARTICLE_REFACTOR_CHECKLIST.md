# 文章发布流程重构 - 完整功能清单

## 数据库和API层

### 1. 数据库Schema更新
- [ ] 在posts表中添加`category`字段（第二层分类）
- [ ] 在posts表中添加`publishedAt`时间戳字段
- [ ] 在posts表中添加`contentCategory`字段（用于区分投资移民、家庭团聚等）
- [ ] 在posts表中添加`status`字段（草稿、预览、已发布、已取消发布）

### 2. tRPC API端点
- [ ] `posts.create` - 创建文章（保存为草稿）
- [ ] `posts.update` - 更新文章
- [ ] `posts.getById` - 获取单篇文章
- [ ] `posts.list` - 列表查询（支持类型、分类、发布状态过滤）
- [ ] `posts.preview` - 获取预览版本
- [ ] `posts.publish` - 发布文章
- [ ] `posts.unpublish` - 取消发布
- [ ] `posts.delete` - 删除文章
- [ ] `posts.getTags` - 获取推荐标签（根据类型和分类）
- [ ] `posts.getCategories` - 获取所有内容分类

## 前端 - 编辑和管理

### 3. 统一文章编辑器（/admin/posts/edit）
- [ ] 合并/admin/posts/new和/admin/posts/:id/edit为单一入口
- [ ] 第一层分类选择（博客文章 / 成功案例）
- [ ] 第二层分类选择（投资移民、家庭团聚等）
- [ ] 标签选择和推荐
- [ ] 封面图上传（拖拽、16:9裁剪）
- [ ] 富文本编辑器
- [ ] 分发面板（LinkedIn、微信公众号）
- [ ] 预览按钮（保存为草稿后预览）
- [ ] 发布按钮（仅在预览确认后显示）

### 4. 文章预览页面（/admin/posts/:id/preview）
- [ ] 显示完整的文章页面布局
- [ ] 与最终发布页面完全相同
- [ ] 返回编辑按钮
- [ ] 确认发布按钮

### 5. 文章管理列表（/admin/posts）
- [ ] 按第一层分类切换（Blog Posts / Success Cases）
- [ ] 按第二层分类过滤
- [ ] 按发布状态显示（已发布、草稿、已取消发布）
- [ ] 编辑按钮
- [ ] 预览按钮
- [ ] 取消发布按钮（仅显示已发布的文章）
- [ ] 删除按钮
- [ ] 发布时间显示

## 前端 - 文章页面

### 6. 文章详情页面（/blog/:slug 或 /success-cases/:slug）
- [ ] 参考heronlaw.ca的布局设计
- [ ] 文章标题、副标题
- [ ] 封面图
- [ ] 发布日期
- [ ] 作者信息
- [ ] 文章正文（富文本渲染）
- [ ] 分类标签显示
- [ ] 相关文章推荐
- [ ] 分享按钮（LinkedIn、微信等）

## 前端 - 列表页面

### 7. 博客文章列表（/blog）
- [ ] 显示所有已发布的博客文章
- [ ] 按发布时间倒序排列
- [ ] 卡片形式展示（封面、标题、摘要、分类、日期）
- [ ] 按第二层分类过滤
- [ ] 按标签过滤
- [ ] 分页或无限滚动

### 8. 成功案例列表（/success-cases）
- [ ] 显示所有已发布的成功案例
- [ ] 按发布时间倒序排列
- [ ] 卡片形式展示
- [ ] 按第二层分类过滤
- [ ] 按标签过滤
- [ ] 分页或无限滚动

### 9. 投资移民页面（/businessclass）
- [ ] 在最下方添加"投资移民成功案例"列表
- [ ] 显示内容分类为"投资移民"的成功案例
- [ ] 卡片形式，位置居左
- [ ] 新发布的文章显示在最上方

### 10. 家庭团聚页面（/familyclass）
- [ ] 在最下方添加"家庭团聚成功案例"列表
- [ ] 显示内容分类为"家庭团聚"的成功案例
- [ ] 卡片形式，位置居左
- [ ] 新发布的文章显示在最上方

### 11. 拒签重审页面（/reconsideration）
- [ ] 在最下方添加"拒签重审成功案例"列表
- [ ] 显示内容分类为"拒签重审"的成功案例
- [ ] 卡片形式，位置居左
- [ ] 新发布的文章显示在最上方

## 功能特性

### 12. 发布管理
- [ ] 文章发布时自动记录`publishedAt`时间戳
- [ ] 取消发布时文章从所有列表页面撤回
- [ ] 取消发布后仍可编辑和重新发布
- [ ] 支持删除已取消发布的文章

### 13. 分发功能
- [ ] LinkedIn一键分享（需集成LinkedIn API）
- [ ] 微信公众号格式转换（复用现有逻辑）

### 14. 标签推荐
- [ ] 根据第一层分类推荐标签
- [ ] 根据第二层分类推荐标签
- [ ] 支持自定义标签

## 总计功能数量

**数据库/API**：10个功能
**编辑和管理**：5个功能
**文章页面**：1个功能
**列表页面**：5个功能
**功能特性**：4个功能

**总计：25个功能**

## 优先级建议

### P0（必须）- 核心功能
1. 数据库Schema更新
2. 统一文章编辑器
3. 文章预览页面
4. 文章管理列表
5. 文章详情页面
6. 博客文章列表
7. 成功案例列表
8. 发布管理功能

### P1（重要）- 增强功能
1. 投资移民/家庭团聚/拒签重审页面的案例列表
2. 标签推荐功能
3. 分类过滤功能

### P2（可选）- 优化功能
1. 分发功能（LinkedIn、微信）
2. 相关文章推荐
3. 分享按钮
